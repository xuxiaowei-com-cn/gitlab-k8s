---
sidebar_position: 1
---

# 离线安装：导读

## 问题

1. 现在你是一个木工
2. 需要去河对岸给造一间房子
3. 造房子一共需要哪些工具是未知的，但现有工具能完全满足造房子的需要
4. 过河费很高，过河携带的工具越多，过河费用越高
5. 不考虑其他因素，如何能携带最少工具过河才能在对岸造房子？
6. 答案在文档最后

## 离线安装使用范围

1. 离线：没有互联网的意思，安装时不从互联网下载软件。
2. 适用于医疗、政企、军工等领域，管理严格，**不允许连接互联网**，在这种环境下，安装GitLab、k8s等软件的情况。
3. 要求固定版本安装的环境，比如任何时候都可以使用指定版本扩展集群中的 node 节点。
4. 要求搭建多个固定版本的环境（**非同一时间搭建：开发环境安装、测试环境安装、生产环境安装**）。
5. 快速搭建。
6. 搭建环境的**网络不好时**的情况。

## 离线安装原理

### 环境准备

1. A 机器：有网络。
2. B 机器：没有网络。
3. A、B 机器除了有无网络以外，其他环境都一样（例如：A、B 机器都是安装的 CentOS 7.9 最小化版本）。

### 安装说明

1. 在 A 机器上安装并缓存依赖，记录安装的顺序。
2. 将 A 机器上安装时缓存的依赖复制到 B 机器上，在 B 机器上执行 A
   机器上安装的顺序（可能命令要有所调整：比如：正常安装软件使用 `yum -y install ***` ，离线安装在 A
   机器上准备时，使用 `yum -y install *** --downloadonly --downloaddir=./下载的文件夹`
   先下载所需的软件，然后在下载目录中运行 `yum -y install *.rpm`就可以选择当前文件夹中的所有以 `*.rpm`
   为后缀的包进行安装了），即可进行离线安装。
3. 如果是 Docker 镜像，可以在 A 机器上安装镜像后，保存成文件，复制到 B 机器上，然后使用本地文件导入 Docker 镜像。

## 问题答案

不考虑其他因素，先造一个房子，记录下所需工具后，把这些工具带到河对岸。
